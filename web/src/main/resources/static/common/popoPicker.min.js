(function(e,i){"use strict";function j(){for(var h,i,j,k,l=arguments.length,e=arguments[0],f=1;f<l;f++)if(i=arguments[f],null!=i)for(h in i)j=e[h],k=i[h],void 0!==k&&(e[h]=k);return e}var b=function(b,t){function u(d){for(var a=0,e=0;e<d.data.length;e++)if(d.data[e].value==d.selected){a=e;break}else a=0;return a}function c(e,a,i,s){var d,t,v=e.data,h="",w=v.length,k=e.infinite,l=u(e);a+=l,i+=l;for(var m,x=a;x<=i;x++)if(m=(0>x?w+x%w:x)%w,d=v[m].value,t=v[m].display,s){var y=0,z="list-item";y=20*-(x-l)%360,k||(0>x||x>w-1?z="none":z="list-item"),h+="<li data-index=\""+x+"\" data-val=\""+d+"\" style=\"transform:rotateX("+y+"deg) translateZ("+85+"px); display: "+z+"\">"+t+"</li>"}else{var A=1;k||(0>x||x>w-1?A=0:A=1),h+="<li data-index=\""+x+"\" data-val=\""+d+"\" style=\"opacity: "+A+"\">"+t+"</li>"}return h}function v(b){var a="";a+="<div class=\"p-select-wrap "+("3d"==t.scrollType?"p-3d":"")+("center"==t.display?" p-center":"")+("dark"==t.background?" dark":"")+"\">",a+="<div class=\"p-select-main\">",a+="<div class=\"p-select-head\">","center"!=t.display&&(a+="<a href=\"javascript:void(0)\" class=\"p-select-cancel-btn\">Annuler</a>"),""!=t.headTitle&&(a+="<div class=\"p-select-title\">"+t.headTitle+"</div>"),"center"!=t.display&&(a+="<a href=\"javascript:void(0)\" class=\"p-select-submit-btn\">Confirmer</a>"),a+="</div>",a+="<div class=\"p-select-body\">",a+="<div class=\"p-select-line\" "+("3d"==t.scrollType?"style=\"transform: translateZ(89px)\"":"")+"></div>";for(var d,f=0;f<b.length;f++)d=b[f].label,a+="<div class=\"p-select-item\">",a+="<div class=\"p-select-col\">",a+="<div class=\"p-select-list\" "+("3d"==t.scrollType?"style=\"transform: translateZ(88px)\"":"")+">",a+="<ul class=\"p-select-ul\">",a+=c(b[f],-9,9,!1),a+="</ul>",a+="</div>","3d"==t.scrollType&&(a+="<ul class=\"p-select-wheel\">",a+=c(b[f],-9,9,!0),a+="</ul>"),a+="</div>",d&&(a+="<div class=\"p-select-col p-select-label\" "+("3d"==t.scrollType?"style=\"transform: translateZ(89px)\"":"")+">"+d+"</div>"),a+="</div>";a+="</div>","center"==t.display&&(a+="<div class=\"p-select-foot\">",a+="<a href=\"javascript:void(0)\" class=\"p-select-cancel-btn\">\u53D6\u6D88</a>",a+="<a href=\"javascript:void(0)\" class=\"p-select-submit-btn\">\u786E\u8BA4</a>",a+="</div>"),a+="</div>",a+="<div class=\"p-select-mask\"></div>",a+="</div>";var j=i.createElement("div");j.className="p-scroll",j.innerHTML=a,i.querySelector(t.container).appendChild(j)}function F(c){var c=l(c),d=l(c%34);return 17>h(d)?c-d:c-d+(0<c?34:-34)}function G(i,a,b,c){var d=a.length,e=(l(-i/34)-9+c)%d,e=0>e?d+e:e,j=l(-i/34)-9+c,g={value:a[e].value,display:a[e].display,dataIndex:j};return g}function H(h){for(var a,i,j,k=getComputedStyle(h),e=["t","webkitT","MozT","OT","msT"],f=0;f<e.length;f++)if(j=e[f],void 0!==k[j+"ransform"]){a=k[j+"ransform"];break}return a=a.split(")")[0].split(", "),i=+(a[13]||a[5]),i}function a(){for(var e=navigator.userAgent,a=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],b=!0,f=0;f<a.length;f++)if(0<e.indexOf(a[f])){b=!1;break}return b}function f(){n={result:[],scrollIdx:0,scrollEvt:[]};var b=i.querySelector(".p-scroll");b.className+=" hide",setTimeout(function(){b.remove()},300)}function e(b,d){v(b);for(var a=i.querySelectorAll(".p-select-item"),c=0;c<a.length;c++){var e=new g.Scroll(a[c],b[c],c),h=G(e.opt.scrollY,e.opt.data,e.opt.infinite,e.opt.selectedIdx);n.result.push(h),n.scrollEvt.push(e),n.scrollIdx=0}t.init(n);var j=i.querySelector(".p-select-submit-btn"),k=i.querySelector(".p-select-cancel-btn"),l=i.querySelector(".p-select-mask");j.addEventListener("click",function(){for(var c=[],a=[],b=0;b<n.result.length;b++)c.push(n.result[b].value),a.push(n.result[b].display);d.setAttribute("data-value",c),d.isInput?d.value=a:d.innerText=a,t.getResult(n),t.save(n,d),g.target=d,f()},!1),k.addEventListener("click",function(){t.cancel(),f()},!1),l.addEventListener("click",function(){t.cancel(),f()},!1),i.querySelector(".p-scroll").addEventListener("touchmove",function(b){b.preventDefault()},!1)}var h=Math.abs,l=Math.round,g=this,t=j({wheels:[],container:"body",scrollType:"3d",background:"light",display:"bottom",headTitle:"",init:function(){},getResult:function(){},save:function(){},cancel:function(){}},t),k=i.querySelectorAll(b),n={result:[],scrollIdx:null,scrollEvt:[]};this.Scroll=function(c,a,b,d){this.el=c,this.wheel=a,this.index=b,this.opt=j({data:this.wheel.data,scrollEl2d:c.querySelector(".p-select-ul"),item2d:c.querySelectorAll(".p-select-ul li"),scrollY:-306,marginTop:0,dataLen:this.wheel.data.length,lastY:1,moveY:0,current:0,infinite:this.wheel.infinite,rotateX:0,selectedIdx:u(a),transTimer:null,scrollTimer:null,clickDown:!1,inertia:!0},d),"3d"==t.scrollType&&(this.opt.scrollEl3d=c.querySelector(".p-select-wheel"),this.opt.item3d=c.querySelectorAll(".p-select-wheel li")),this.defaultScrollY=this.opt.scrollY,this.init()},this.Scroll.prototype={init:function(){this.Run(0,this.opt.scrollY),a()?(this.el.addEventListener("mousedown",this.touchStart.bind(this),!1),i.addEventListener("mousemove",this.touchMove.bind(this),!1),i.addEventListener("mouseup",this.touchEnd.bind(this),!1)):(this.el.addEventListener("touchstart",this.touchStart.bind(this),!1),this.el.addEventListener("touchmove",this.touchMove.bind(this),!1),this.el.addEventListener("touchend",this.touchEnd.bind(this),!1),this.el.addEventListener("touchcancel",this.touchEnd.bind(this),!1)),this,"3d"==t.scrollType?this.itemClick(this.opt.item3d):this.itemClick(this.opt.item2d)},itemClick:function(d){for(var e=this,a=0;a<d.length;a++)d[a].addEventListener("click",function(b){e.opt.inertia=!1;var a=+b.target.dataset.index,c=n.result[e.index].dataIndex;e.cusTouch(a-c)},!1)},Run:function(c,a){0==c?(this.opt.scrollEl2d.style.webkitTransition="none","3d"==t.scrollType&&(this.opt.scrollEl3d.style.webkitTransition="none")):(this.opt.scrollEl2d.style.webkitTransition="transform cubic-bezier(0.190, 1.000, 0.220, 1.000) "+c+"ms","3d"==t.scrollType&&(this.opt.scrollEl3d.style.webkitTransition="transform cubic-bezier(0.190, 1.000, 0.220, 1.000) "+c+"ms")),this.opt.scrollEl2d.style.webkitTransform="translate3d(0,"+a+"px, 0)","3d"==t.scrollType&&(a=l(-(a*(20/34))-180),this.opt.scrollEl3d.style.webkitTransform="rotateX("+a+"deg) translate3d(0,0,0)")},scrollDone:function(){clearInterval(this.opt.scrollTimer),clearTimeout(this.opt.transTimer)},onMove:function(d,i){var b=this,d=d||H(this.opt.scrollEl2d),c=l(-d/34)-9,p=c-this.opt.current;if(null!=i||p){this.opt.current=c;for(var f=0;f<this.opt.item2d.length;f++){var q=this.opt.item2d[f],c=+q.getAttribute("data-index")+p,r=b.opt.dataLen,s=(0>c?r+c%r:c)%r,u=b.opt.data[s].value,v=b.opt.data[s].display;b.opt.infinite||(0>c||c>r-1?q.style.opacity="0":q.style.opacity="1"),q.setAttribute("data-index",c),q.setAttribute("data-val",u),q.innerText=v}if("3d"==t.scrollType)for(var f=0;f<this.opt.item3d.length;f++){var q=this.opt.item3d[f],c=+q.getAttribute("data-index")+p,r=b.opt.dataLen,s=(0>c?r+c%r:c)%r,u=b.opt.data[s].value,w=-(c-b.opt.selectedIdx)*20,v=b.opt.data[s].display;b.opt.infinite||(0>c||c>r-1?q.style.display="none":q.style.display="list-item"),q.setAttribute("data-index",c),q.setAttribute("data-val",u),q.setAttribute("data-idx",s),q.innerText=v,q.style.webkitTransform="rotateX("+w+"deg) translateZ("+85+"px)"}this.opt.marginTop+=p*34,this.opt.scrollEl2d.style.marginTop=this.opt.marginTop+"px"}},touchStart:function(b){"touchstart"==b.type?this.opt.startY=b.targetTouches[0].clientY:(this.opt.startY=b.clientY,this.opt.clickDown=!0),this.opt.startTime=new Date},touchMove:function(c){if("touchmove"==c.type){c.preventDefault();for(var a=0;a<c.targetTouches.length;a++)this.opt.curY=c.targetTouches[a].clientY}else if(this.opt.clickDown)this.opt.curY=c.clientY;else return!1;this.opt.moveY=this.opt.curY-this.opt.startY,this.opt.distance=this.opt.scrollY+this.opt.moveY,this.opt.curY<this.opt.lastY?this.opt.direction=1:this.opt.curY>this.opt.lastY&&(this.opt.direction=-1),this.opt.direction&&(this.onMove(),this.opt.lastY=this.opt.curY,this.Run(0,this.opt.distance))},touchEnd:function(d){if("touchend"==d.type)this.opt.lastY=d.changedTouches[0].clientY;else if(this.opt.clickDown)this.opt.lastY=d.clientY,this.opt.clickDown=!1;else return!1;this.opt.endTime=new Date;var a=this,b=this.opt.endTime-this.opt.startTime,c=500,k=0;if(this.opt.inertia&&300>b?(c=h(this.opt.moveY/b),c=l(1e3*c),k=c/3*(0>this.opt.moveY?-1:1),c=500>c?500:c):(k=this.opt.moveY,this.opt.inertia=!0),this.opt.scrollY+=F(k),this.opt.moveY=0,clearInterval(this.opt.scrollTimer),this.opt.scrollTimer=setInterval(function(){a.onMove()},100),clearTimeout(this.opt.transTimer),this.opt.transTimer=setTimeout(function(){a.onMove(),a.scrollDone()},c),!this.opt.infinite){var m=this.opt.selectedIdx*34-306,g=this.opt.selectedIdx*34-34*(this.opt.dataLen-1)-306;this.opt.scrollY>m?this.opt.scrollY=m:this.opt.scrollY<g&&(this.opt.scrollY=g)}this.Run(c,this.opt.scrollY);var i=G(this.opt.scrollY,this.opt.data,this.opt.infinite,this.opt.selectedIdx);n.result[this.index]=i,n.scrollIdx=this.index,t.getResult(n)},cusTouch:function(b){this.touchStart({clientY:0,targetTouches:[{clientY:0}],type:"click"}),this.touchMove({clientY:-34*b,targetTouches:[{clientY:-34*b}],type:"click"}),this.touchEnd({clientY:-34*b,changedTouches:[{clientY:-34*b}],type:"click"})},scrollTo:function(e,a){this.wheel.selected=e;var b=u(this.wheel),c=this.opt.selectedIdx-b;this.opt.scrollY=this.defaultScrollY+c*34,this.Run(a,this.opt.scrollY),this.onMove(this.opt.scrollY,!0)},removeItem:function(h){for(var a=this.opt.data,b=n.result[this.index].value,c=0,i=!1,j=0;j<a.length;j++)for(var k=0;k<h.length;k++)a[j].value==h[k]?(a.splice(j--,1),c++):h[k]==b&&(i=!0);i&&(n.result[this.index]={value:a[a.length-1].value,display:a[a.length-1].display}),this.opt.dataLen=a.length,this.scrollTo(n.result[this.index].value,0)},appendItem:function(e){for(var a=this.opt.data,b=0;b<a.length;b++)for(var f=0;f<e.length;f++)a[b].value==e[f].value&&e.splice(f--,1);for(var b=0;b<e.length;b++)a.push(e[b]);this.opt.dataLen=a.length,this.scrollTo(n.result[this.index].value,0)}};for(var m=0;m<k.length;m++){var o=k[m],p=t.wheels,q="input"==o.localName||"textarea"==o.localName,r=o.getAttribute("data-value");if(r){r=r.split(",");for(var s=[],y=0;y<r.length;y++){p[y].selected=r[y];var z=u(p[y]);s.push(p[y].data[z].display)}q?o.value=s:o.innerText=s}q&&(o.setAttribute("readonly","readonly"),o.setAttribute("unselectable","on")),o.addEventListener("click",function(){var f=this,a=JSON.parse(JSON.stringify(p)),b=f.getAttribute("data-value");if(f.isInput=q,q&&f.blur(),b){b=b.split(",");for(var g=0;g<b.length;g++)a[g].selected=b[g];e(a,f,q)}else e(p,f,q)},!1)}};e.popoPicker=b,e.popoDateTime=function(c,d){function a(b){return 10>b?"0"+b:b+""}function f(b){return 0==b%4&&0!=b%100||0==b%400}function g(d,a,b){d.appendItem([{value:"29",display:"29"},{value:"30",display:"30"},{value:"31",display:"31"}]),"04"==b||"06"==b||"09"==b||"11"==b?d.removeItem(["31"]):"02"==b&&(f(a)?d.removeItem(["30","31"]):d.removeItem(["29","30","31"]))}function h(b){if(x=5==b.length?b[0].display+"-"+b[1].display+"-"+b[2].display+" "+b[3].display+":"+b[4].display:3==b.length?b[0].display+"-"+b[1].display+"-"+b[2].display:b[0].display+":"+b[1].display,d.headResult){var a=i.querySelector(".p-select-title");a.innerText=x}}for(var d=j({container:"body",scrollType:"3d",background:"light",showLabel:!0,labelType:"symbol",display:"bottom",headResult:!1,date:!0,time:!0,beginYear:new Date().getFullYear()-100,endYear:new Date().getFullYear()+100,startDate:"",save:function(){},cancel:function(){}},d),G=new Date,k=G.getFullYear(),H=G.getMonth()+1,I=G.getDate(),n=G.getHours(),o=G.getMinutes(),q=d.beginYear,r=d.endYear,s=[],t=[],u=[],v=[],w=[],x="",J=[{infinite:!1,selected:a(k),label:"<span>-</span>",data:s},{infinite:!0,selected:a(H),label:"<span>-</span>",data:t},{infinite:!0,selected:a(I),label:"",data:u},{infinite:!0,selected:a(n),label:"<span>:</span>",data:v},{infinite:!0,selected:a(o),label:"",data:w}],z=q;z<=r;z++)s.push({value:a(z),display:a(z)});for(var z=1;12>=z;z++)t.push({value:a(z),display:a(z)});for(var z=1;31>=z;z++)u.push({value:a(z),display:a(z)});for(var z=0;23>=z;z++)v.push({value:a(z),display:a(z)});for(var z=0;59>=z;z++)w.push({value:a(z),display:a(z)});if(d.date||J.splice(0,3),d.time||(J.splice(3,5),J[2].label=" "),!d.showLabel)for(var z=0;z<J.length;z++)delete J[z].label;else{if("text"==d.labelType)for(var K=["\u5E74","\u6708","\u65E5","\u65F6","\u5206","\u79D2"],z=0;z<J.length;z++)J[z].label=K[z];if("split"==d.labelType&&d.date&&d.time){for(var z=0;z<J.length;z++)delete J[z].label;J[2].label="<div class=\"p-select-time-split-1\"></div>"}}for(var B=new b(c,{wheels:J,scrollType:d.scrollType,background:d.background,display:d.display,headTitle:d.headResult?1:"",container:d.container,init:function(e){if(d.date){var a=e.result[0].value,b=e.result[1].value;g(e.scrollEvt[2],a,b)}h(e.result)},getResult:function(c){var a=d.date&&(0==c.scrollIdx||1==c.scrollIdx);k=c.result[0].value,H=c.result[1].value,a&&g(c.scrollEvt[2],k,H),h(c.result)},save:function(c,a){a.isInput?a.value=x:a.innerText=x,d.save(x,a)},cancel:function(){d.cancel()}}),C=i.querySelectorAll(c),z=0;z<C.length;z++){var p=C[z],D="input"==p.localName||"textarea"==p.localName,E=D?p.value:p.innerText;E&&(E=E.match(/\d+/g),p.setAttribute("data-value",E))}}})(window,document);